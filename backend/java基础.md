# Java基础

## Java vs C++

- Java只支持单继承，但可以实现多个接口，弥补单继承的短板，而C++支持多继承
  - 多继承本身存在菱形问题，B和C继承了A，D继承了B和C，如果B和C重写了A的方法，在D中调用时会存在歧义
  - 多继承会让类之间的关系变得复杂，难以维护
- Java的内存管理是由垃圾回收线程在后台自动处理的，C++的内存管理需要开发者手动维护
- Java具有平台无关性，字节码可以跨平台使用
- Java只支持方法重载，不支持运算符重载，C++两者都支持

## 多接口实现不存在菱形问题

多实现不会存在菱形问题，因为一个接口中的方法，因为在实现类中，这个方法是一定要被重写的，也就是说调用的方法一定是自己重写的方法，不会存在歧义

JDK9引入了接口默认方法，默认方法存在菱形问题，默认方法特例：如果A实现了接口B，C继承了A，同时实现了B，那调用方法时，调用的是重写过的方法；如果一个类实现了A和B两个接口，两个接口有相同的默认方法，那类必须重写这个方法，否则存在歧义

如果A、B两个接口有同名方法，参数也相同，只有返回值不同，这样一个类是不能同时实现A和B的，因为方法签名只由方法名和参数决定，返回值并不属于签名的一部分，这种情况下编译器会报错

## JVM的作用

JVM是运行Java字节码的虚拟机，负责将编译器的编译结果也就是字节码加载进内存并转化成运行时数据结构，并对字节码逐行解释运行，字节码+不同系统的JVM的特定实现是实现Java语言平台无关性的关键所在

## 采用字节码的好处

- 字节码相对于Java源代码更接近计算机底层，执行效率更高
- JVM可以识别字节码，但不能识别Java源代码，字节码+JVM可以实现一次编译，处处运行

字节码保留了解释型语言执行效率低的问题，也保留了解释型语言可移植的优点

![java编译解释流程](https://github.com/Xuxiusheng/notes/blob/main/photos/compile-pipeline.png)

## 编译器

- AOT: 一次性将字节码编译成机器码，启动时间以及内存占用都很小，但是峰值性能相对较弱，而且不支持Java的动态特性，比如反射
- JIT：逐行解释字节码，在运行时会收集运行信息，针对热点代码进行编译，由于会收集运行状态信息，极限处理能力更强，但是冷启动问题以及内存占用问题比较严重

如何确定是否为热点代码：JIT会统计方法或者代码块在一定时间内的调用次数，如果超过了给定的阈值，就认为是热点代码对其编译，编译的代码存入codeCache，位于方法区
